/* tracker-entry.c generated by valac, the Vala compiler
 * generated from tracker-entry.gs, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <stdlib.h>
#include <string.h>
#include <glib/gi18n-lib.h>
#include <gdk/gdk.h>


#define TYPE_TRACKER_SEARCH_ENTRY (tracker_search_entry_get_type ())
#define TRACKER_SEARCH_ENTRY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TRACKER_SEARCH_ENTRY, TrackerSearchEntry))
#define TRACKER_SEARCH_ENTRY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TRACKER_SEARCH_ENTRY, TrackerSearchEntryClass))
#define IS_TRACKER_SEARCH_ENTRY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TRACKER_SEARCH_ENTRY))
#define IS_TRACKER_SEARCH_ENTRY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TRACKER_SEARCH_ENTRY))
#define TRACKER_SEARCH_ENTRY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TRACKER_SEARCH_ENTRY, TrackerSearchEntryClass))

typedef struct _TrackerSearchEntry TrackerSearchEntry;
typedef struct _TrackerSearchEntryClass TrackerSearchEntryClass;
typedef struct _TrackerSearchEntryPrivate TrackerSearchEntryPrivate;

#define TYPE_TRACKER_QUERY (tracker_query_get_type ())
#define TRACKER_QUERY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_TRACKER_QUERY, TrackerQuery))
#define TRACKER_QUERY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_TRACKER_QUERY, TrackerQueryClass))
#define IS_TRACKER_QUERY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_TRACKER_QUERY))
#define IS_TRACKER_QUERY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_TRACKER_QUERY))
#define TRACKER_QUERY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_TRACKER_QUERY, TrackerQueryClass))

typedef struct _TrackerQuery TrackerQuery;
typedef struct _TrackerQueryClass TrackerQueryClass;
#define _g_free0(var) (var = (g_free (var), NULL))

struct _TrackerSearchEntry {
	GtkEntry parent_instance;
	TrackerSearchEntryPrivate * priv;
	guint id_invoker;
};

struct _TrackerSearchEntryClass {
	GtkEntryClass parent_class;
};

struct _TrackerSearchEntryPrivate {
	TrackerQuery* _Query;
};


static gpointer tracker_search_entry_parent_class = NULL;
static GtkActivatableIface* tracker_search_entry_gtk_activatable_parent_iface = NULL;

#define RUN_DELAY 500
GType tracker_search_entry_get_type (void);
GType tracker_query_get_type (void);
#define TRACKER_SEARCH_ENTRY_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_TRACKER_SEARCH_ENTRY, TrackerSearchEntryPrivate))
enum  {
	TRACKER_SEARCH_ENTRY_DUMMY_PROPERTY,
	TRACKER_SEARCH_ENTRY_QUERY
};
TrackerQuery* tracker_search_entry_get_Query (TrackerSearchEntry* self);
void tracker_query_set_SearchTerms (TrackerQuery* self, const char* value);
static gboolean tracker_search_entry_run_query (TrackerSearchEntry* self);
static gboolean _tracker_search_entry_run_query_gsource_func (gpointer self);
static void tracker_search_entry_entry_changed (TrackerSearchEntry* self, GtkEditable* editable);
static void tracker_search_entry_entry_activate (TrackerSearchEntry* self, TrackerSearchEntry* entry);
char* tracker_utils_EscapeSparql (const char* sparql, gboolean add_wildcard);
static void tracker_search_entry_real_sync_action_properties (GtkActivatable* base, GtkAction* action);
static void tracker_search_entry_real_update (GtkActivatable* base, GtkAction* action, const char* prop);
TrackerSearchEntry* tracker_search_entry_new (void);
TrackerSearchEntry* tracker_search_entry_construct (GType object_type);
void tracker_search_entry_set_Query (TrackerSearchEntry* self, TrackerQuery* value);
static void _tracker_search_entry_entry_activate_gtk_entry_activate (TrackerSearchEntry* _sender, gpointer self);
static void _tracker_search_entry_entry_changed_gtk_editable_changed (TrackerSearchEntry* _sender, gpointer self);
static void _lambda1_ (GtkEntryIconPosition p0, GdkEvent* p1, TrackerSearchEntry* self);
static void __lambda1__gtk_entry_icon_press (TrackerSearchEntry* _sender, GtkEntryIconPosition p0, GdkEvent* p1, gpointer self);
static GObject * tracker_search_entry_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties);
static void tracker_search_entry_finalize (GObject* obj);
static void tracker_search_entry_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void tracker_search_entry_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);
static int _vala_strcmp0 (const char * str1, const char * str2);



#line 63 "tracker-entry.gs"
static gboolean _tracker_search_entry_run_query_gsource_func (gpointer self) {
#line 89 "tracker-entry.c"
	return tracker_search_entry_run_query (self);
}


#line 47 "tracker-entry.gs"
static void tracker_search_entry_entry_changed (TrackerSearchEntry* self, GtkEditable* editable) {
#line 47 "tracker-entry.gs"
	g_return_if_fail (self != NULL);
#line 47 "tracker-entry.gs"
	g_return_if_fail (editable != NULL);
#line 48 "tracker-entry.gs"
	if (self->priv->_Query != NULL) {
#line 49 "tracker-entry.gs"
		if (gtk_entry_get_text ((GtkEntry*) self) == NULL) {
#line 50 "tracker-entry.gs"
			tracker_query_set_SearchTerms (self->priv->_Query, "");
#line 51 "tracker-entry.gs"
			if (self->id_invoker != 0) {
#line 52 "tracker-entry.gs"
				g_source_remove (self->id_invoker);
#line 53 "tracker-entry.gs"
				self->id_invoker = (guint) 0;
#line 112 "tracker-entry.c"
			}
#line 54 "tracker-entry.gs"
			gtk_entry_set_icon_sensitive ((GtkEntry*) self, GTK_ENTRY_ICON_SECONDARY, FALSE);
#line 116 "tracker-entry.c"
		} else {
#line 56 "tracker-entry.gs"
			if (self->id_invoker != 0) {
#line 57 "tracker-entry.gs"
				g_source_remove (self->id_invoker);
#line 122 "tracker-entry.c"
			}
#line 58 "tracker-entry.gs"
			self->id_invoker = g_timeout_add_full (G_PRIORITY_DEFAULT, (guint) RUN_DELAY, _tracker_search_entry_run_query_gsource_func, g_object_ref (self), g_object_unref);
#line 126 "tracker-entry.c"
		}
	}
}


#line 60 "tracker-entry.gs"
static void tracker_search_entry_entry_activate (TrackerSearchEntry* self, TrackerSearchEntry* entry) {
#line 60 "tracker-entry.gs"
	g_return_if_fail (self != NULL);
#line 60 "tracker-entry.gs"
	g_return_if_fail (entry != NULL);
#line 61 "tracker-entry.gs"
	gtk_widget_grab_focus ((GtkWidget*) entry);
#line 140 "tracker-entry.c"
}


#line 63 "tracker-entry.gs"
static gboolean tracker_search_entry_run_query (TrackerSearchEntry* self) {
#line 146 "tracker-entry.c"
	gboolean result = FALSE;
#line 63 "tracker-entry.gs"
	g_return_val_if_fail (self != NULL, FALSE);
#line 64 "tracker-entry.gs"
	if (self->priv->_Query != NULL) {
#line 152 "tracker-entry.c"
		gboolean _tmp0_ = FALSE;
#line 65 "tracker-entry.gs"
		if (gtk_entry_get_text ((GtkEntry*) self) == NULL) {
#line 65 "tracker-entry.gs"
			_tmp0_ = TRUE;
#line 158 "tracker-entry.c"
		} else {
#line 65 "tracker-entry.gs"
			_tmp0_ = _vala_strcmp0 (gtk_entry_get_text ((GtkEntry*) self), "") == 0;
#line 162 "tracker-entry.c"
		}
#line 65 "tracker-entry.gs"
		if (_tmp0_) {
#line 66 "tracker-entry.gs"
			gtk_entry_set_icon_sensitive ((GtkEntry*) self, GTK_ENTRY_ICON_SECONDARY, FALSE);
#line 67 "tracker-entry.gs"
			tracker_query_set_SearchTerms (self->priv->_Query, "");
#line 170 "tracker-entry.c"
		} else {
			char* _tmp1_;
#line 69 "tracker-entry.gs"
			gtk_entry_set_icon_sensitive ((GtkEntry*) self, GTK_ENTRY_ICON_SECONDARY, TRUE);
#line 70 "tracker-entry.gs"
			tracker_query_set_SearchTerms (self->priv->_Query, _tmp1_ = tracker_utils_EscapeSparql (gtk_entry_get_text ((GtkEntry*) self), TRUE));
#line 177 "tracker-entry.c"
			_g_free0 (_tmp1_);
		}
	}
	result = FALSE;
#line 71 "tracker-entry.gs"
	return result;
#line 184 "tracker-entry.c"
}


#line 73 "tracker-entry.gs"
static void tracker_search_entry_real_sync_action_properties (GtkActivatable* base, GtkAction* action) {
#line 190 "tracker-entry.c"
	TrackerSearchEntry * self;
	self = (TrackerSearchEntry*) base;
#line 73 "tracker-entry.gs"
	g_return_if_fail (action != NULL);
#line 74 "tracker-entry.gs"
	return;
#line 197 "tracker-entry.c"
}


#line 76 "tracker-entry.gs"
static void tracker_search_entry_real_update (GtkActivatable* base, GtkAction* action, const char* prop) {
#line 203 "tracker-entry.c"
	TrackerSearchEntry * self;
	self = (TrackerSearchEntry*) base;
#line 76 "tracker-entry.gs"
	g_return_if_fail (action != NULL);
#line 76 "tracker-entry.gs"
	g_return_if_fail (prop != NULL);
#line 77 "tracker-entry.gs"
	return;
#line 212 "tracker-entry.c"
}


#line 30 "tracker-entry.gs"
TrackerSearchEntry* tracker_search_entry_construct (GType object_type) {
#line 218 "tracker-entry.c"
	TrackerSearchEntry * self;
	self = g_object_newv (object_type, 0, NULL);
	return self;
}


#line 30 "tracker-entry.gs"
TrackerSearchEntry* tracker_search_entry_new (void) {
#line 30 "tracker-entry.gs"
	return tracker_search_entry_construct (TYPE_TRACKER_SEARCH_ENTRY);
#line 229 "tracker-entry.c"
}


TrackerQuery* tracker_search_entry_get_Query (TrackerSearchEntry* self) {
	TrackerQuery* result;
	g_return_val_if_fail (self != NULL, NULL);
	result = self->priv->_Query;
#line 33 "tracker-entry.gs"
	return result;
#line 239 "tracker-entry.c"
}


void tracker_search_entry_set_Query (TrackerSearchEntry* self, TrackerQuery* value) {
	g_return_if_fail (self != NULL);
	self->priv->_Query = value;
	g_object_notify ((GObject *) self, "Query");
}


#line 60 "tracker-entry.gs"
static void _tracker_search_entry_entry_activate_gtk_entry_activate (TrackerSearchEntry* _sender, gpointer self) {
#line 252 "tracker-entry.c"
	tracker_search_entry_entry_activate (self, _sender);
}


#line 47 "tracker-entry.gs"
static void _tracker_search_entry_entry_changed_gtk_editable_changed (TrackerSearchEntry* _sender, gpointer self) {
#line 259 "tracker-entry.c"
	tracker_search_entry_entry_changed (self, _sender);
}


#line 42 "tracker-entry.gs"
static void _lambda1_ (GtkEntryIconPosition p0, GdkEvent* p1, TrackerSearchEntry* self) {
#line 42 "tracker-entry.gs"
	g_return_if_fail (p1 != NULL);
#line 43 "tracker-entry.gs"
	if (p0 == GTK_ENTRY_ICON_SECONDARY) {
#line 44 "tracker-entry.gs"
		gtk_entry_set_text ((GtkEntry*) self, "");
#line 272 "tracker-entry.c"
	}
}


#line 42 "tracker-entry.gs"
static void __lambda1__gtk_entry_icon_press (TrackerSearchEntry* _sender, GtkEntryIconPosition p0, GdkEvent* p1, gpointer self) {
#line 279 "tracker-entry.c"
	_lambda1_ (p0, p1, self);
}


static GObject * tracker_search_entry_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties) {
	GObject * obj;
	GObjectClass * parent_class;
	TrackerSearchEntry * self;
	parent_class = G_OBJECT_CLASS (tracker_search_entry_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = TRACKER_SEARCH_ENTRY (obj);
	{
#line 36 "tracker-entry.gs"
		gtk_entry_set_icon_from_stock ((GtkEntry*) self, GTK_ENTRY_ICON_SECONDARY, GTK_STOCK_CLEAR);
#line 37 "tracker-entry.gs"
		gtk_entry_set_icon_sensitive ((GtkEntry*) self, GTK_ENTRY_ICON_PRIMARY, FALSE);
#line 38 "tracker-entry.gs"
		gtk_entry_set_icon_sensitive ((GtkEntry*) self, GTK_ENTRY_ICON_SECONDARY, FALSE);
#line 39 "tracker-entry.gs"
		gtk_entry_set_icon_tooltip_text ((GtkEntry*) self, GTK_ENTRY_ICON_SECONDARY, _ ("Clear the search text"));
#line 40 "tracker-entry.gs"
		g_signal_connect_object ((GtkEntry*) self, "activate", (GCallback) _tracker_search_entry_entry_activate_gtk_entry_activate, self, 0);
#line 41 "tracker-entry.gs"
		g_signal_connect_object ((GtkEditable*) self, "changed", (GCallback) _tracker_search_entry_entry_changed_gtk_editable_changed, self, 0);
#line 42 "tracker-entry.gs"
		g_signal_connect_object ((GtkEntry*) self, "icon-press", (GCallback) __lambda1__gtk_entry_icon_press, self, 0);
#line 306 "tracker-entry.c"
	}
	return obj;
}


static void tracker_search_entry_class_init (TrackerSearchEntryClass * klass) {
	tracker_search_entry_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (TrackerSearchEntryPrivate));
	G_OBJECT_CLASS (klass)->get_property = tracker_search_entry_get_property;
	G_OBJECT_CLASS (klass)->set_property = tracker_search_entry_set_property;
	G_OBJECT_CLASS (klass)->constructor = tracker_search_entry_constructor;
	G_OBJECT_CLASS (klass)->finalize = tracker_search_entry_finalize;
	g_object_class_install_property (G_OBJECT_CLASS (klass), TRACKER_SEARCH_ENTRY_QUERY, g_param_spec_object ("Query", "Query", "Query", TYPE_TRACKER_QUERY, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
}


static void tracker_search_entry_gtk_activatable_interface_init (GtkActivatableIface * iface) {
	tracker_search_entry_gtk_activatable_parent_iface = g_type_interface_peek_parent (iface);
	iface->sync_action_properties = tracker_search_entry_real_sync_action_properties;
	iface->update = tracker_search_entry_real_update;
}


static void tracker_search_entry_instance_init (TrackerSearchEntry * self) {
	self->priv = TRACKER_SEARCH_ENTRY_GET_PRIVATE (self);
	self->id_invoker = (guint) 0;
}


static void tracker_search_entry_finalize (GObject* obj) {
	TrackerSearchEntry * self;
	self = TRACKER_SEARCH_ENTRY (obj);
	G_OBJECT_CLASS (tracker_search_entry_parent_class)->finalize (obj);
}


GType tracker_search_entry_get_type (void) {
	static volatile gsize tracker_search_entry_type_id__volatile = 0;
	if (g_once_init_enter (&tracker_search_entry_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (TrackerSearchEntryClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) tracker_search_entry_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (TrackerSearchEntry), 0, (GInstanceInitFunc) tracker_search_entry_instance_init, NULL };
		static const GInterfaceInfo gtk_activatable_info = { (GInterfaceInitFunc) tracker_search_entry_gtk_activatable_interface_init, (GInterfaceFinalizeFunc) NULL, NULL};
		GType tracker_search_entry_type_id;
		tracker_search_entry_type_id = g_type_register_static (GTK_TYPE_ENTRY, "TrackerSearchEntry", &g_define_type_info, 0);
		g_type_add_interface_static (tracker_search_entry_type_id, GTK_TYPE_ACTIVATABLE, &gtk_activatable_info);
		g_once_init_leave (&tracker_search_entry_type_id__volatile, tracker_search_entry_type_id);
	}
	return tracker_search_entry_type_id__volatile;
}


static void tracker_search_entry_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	TrackerSearchEntry * self;
	self = TRACKER_SEARCH_ENTRY (object);
	switch (property_id) {
		case TRACKER_SEARCH_ENTRY_QUERY:
		g_value_set_object (value, tracker_search_entry_get_Query (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void tracker_search_entry_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	TrackerSearchEntry * self;
	self = TRACKER_SEARCH_ENTRY (object);
	switch (property_id) {
		case TRACKER_SEARCH_ENTRY_QUERY:
		tracker_search_entry_set_Query (self, g_value_get_object (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static int _vala_strcmp0 (const char * str1, const char * str2) {
	if (str1 == NULL) {
		return -(str1 != str2);
	}
	if (str2 == NULL) {
		return str1 != str2;
	}
	return strcmp (str1, str2);
}




